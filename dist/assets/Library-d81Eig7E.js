import{R as r,j as e}from"./index-D8mHM_0A.js";import{y as x,g as m,d as u,a as g}from"./db-1gINX9ct.js";function p({file:a}){const[s,l]=r.useState("");return r.useEffect(()=>{const d=URL.createObjectURL(a.blob);return l(d),()=>URL.revokeObjectURL(d)},[a]),a.type.startsWith("image/")?e.jsx("img",{src:s,alt:a.name,className:"w-full h-36 object-cover rounded-lg",loading:"lazy",decoding:"async"}):a.type.startsWith("video/")?e.jsx("video",{src:s,className:"w-full h-36 object-cover rounded-lg",controls:!0,preload:"metadata"}):a.type.startsWith("audio/")?e.jsx("audio",{src:s,className:"w-full",controls:!0,preload:"none"}):e.jsxs("a",{href:s,download:a.name,className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-white/5",children:["⬇️ ",a.name]})}function b(){const[a,s]=r.useState([]),[l,d]=r.useState(x()),c=r.useCallback(async()=>{const t=await m();t.sort((n,o)=>o.createdAt-n.createdAt),s(t)},[]);r.useEffect(()=>{c()},[c]);const i=async t=>{const n=Array.from(t.target.files||[]);for(const o of n)await g({file:o,date:l});t.target.value="",await c()};return e.jsxs("section",{className:"max-w-6xl mx-auto px-6 py-10",children:[e.jsx("h2",{className:"text-2xl font-semibold gradient-text",children:"Файлы"}),e.jsxs("div",{className:"mt-4 glass p-4 flex flex-col sm:flex-row gap-3 items-center",children:[e.jsx("input",{type:"date",value:l,onChange:t=>d(t.target.value),className:"input max-w-[14rem]"}),e.jsxs("label",{className:"btn cursor-pointer",tabIndex:"0",children:["Загрузить файлы",e.jsx("input",{type:"file",multiple:!0,className:"hidden",onChange:i})]})]}),e.jsxs("div",{className:"mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[a.length===0&&e.jsx("div",{className:"text-white/60",children:"Пока нет файлов"}),a.map(t=>e.jsxs("div",{className:"glass p-3 flex flex-col gap-2",children:[e.jsx(p,{file:t}),e.jsx("div",{className:"text-sm text-slate-700 dark:text-slate-300 truncate",children:t.name}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:[t.date," · ",(t.size/1024).toFixed(1)," KB"]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:async()=>{await u(t.id),await c()},className:"px-3 py-1.5 rounded-md border border-red-200/60 dark:border-red-800/60 text-red-700 dark:text-red-300 hover:bg-red-50/60 dark:hover:bg-red-900/10",children:"Удалить"})})]},t.id))]})]})}export{b as default};
